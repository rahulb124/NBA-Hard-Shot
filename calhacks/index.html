<!html>

<head>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script
  src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
  integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
  crossorigin="anonymous"></script>
<link href="dist/css/tabulator.min.css" rel="stylesheet">
<script type="text/javascript" src="dist/js/tabulator.min.js"></script>
</head>
<style>
.dropbtn {
    background-color: #4CAF50;
    color: white;
    padding: 16px;
    font-size: 16px;
    border: none;
    cursor: pointer;
}

.h2 {
	position:center;
}

.dropbtn:hover, .dropbtn:focus {
    background-color: #3e8e41;
}
#myInput {
    border-box: box-sizing;
    background-position: 14px 12px;
    background-repeat: no-repeat;
    font-size: 16px;
    padding: 14px 20px 12px 45px;
    border: none;
}

.dropdown {
    position: relative;
    display: inline-block;
}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #f6f6f6;
    min-width: 230px;
    overflow: auto;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
}

.dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}

.dropdown a:hover {background-color: #ddd}

.show {display:block;}

.container {
  width: 80%;
  margin: 15px auto;
}

.hide {
  display: none;
}

</style>
<title>aLert</title>
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
    </div>
    <ul class="nav navbar-nav">
      <li class="active"><a data-ajax="false" href="/calhacks/index.html">Dashboard</a></li>
    </ul>
  </div>
</nav>
<h1>Dashboard</h1>
<script>
//failed syc on github
var dump = $.getJSON( "/calhacks/scape.json", function() {
  console.log( "success" );
  window.lol = JSON.parse(dump.responseText);
})
</script>
<script>
class AccessPoint {
   	constructor(id,name,clients,percent, level){
        this.id = id;
        this.name = name;
        this.clients = clients;
        this.percent = percent;
        this.level = level;
        this.optimization = 0;
       }
    };

function optimizationnation(APL){
	floor1 = 0;
	floor2 = 0;
	floor3 = 0;
	floor4 = 0;
	for (i = 0; i < APL.length; i++){
		if (APL[i].level == 1){
			floor1 += APL[i].clients;
		}
		if (APL[i].level == 2){
			floor2 += APL[i].clients;
		}
		if (APL[i].level == 3){
			floor3 += APL[i].clients;
		}
		if (APL[i].level == 4){
			floor4 += APL[i].clients;
		}
	}
	for (i = 0; i < APL.length; i++){
		if (APL[i].level == 1){
			APL[i].optimization = Math.round((APL[i].clients / floor1) * 100 / APL[i].percent * 100)
		}
		if (APL[i].level == 2){
			APL[i].optimization = Math.round((APL[i].clients / floor2) * 100 / APL[i].percent * 100)
		}
		if (APL[i].level == 3){
			APL[i].optimization = Math.round((APL[i].clients / floor3) * 100 / APL[i].percent * 100)
		}
		if (APL[i].level == 4){
			APL[i].optimization = Math.round((APL[i].clients / floor4) * 100 / APL[i].percent * 100)
		}
	}
};
function emergencyupdate(eAP, APL){
		var dangerfloor = eAP.level;
		var dangerid = eAP.id;
		var samefloorid = [];
		var dangerpeople = eAP.clients;
		var totalpeople = 0;
		for (i = 0; i < APL.length; i++) {
			if (APL[i].level == dangerfloor) {
				samefloorid.push(APL[i].id);
				totalpeople += APL[i].clients;
			}
		}
		var split = Math.round(totalpeople/samefloorid.length);

		for (i = 0; i < APL.length; i++) {
			if (APL[i].id != dangerid && samefloorid.includes(APL[i].id)) {
				APL[i].percent = Math.round(100/(samefloorid.length - 1));
				APL[i].clients += split;


			}
		}
		alert(dangerpeople + "users have been redirected to another exit")
};

var AP0 = new AccessPoint(13803418528385,"Microsoft Bar", 75, 20, 1);
var AP1 = new AccessPoint(13803418551334,"Concur", 42, 30, 1);
var AP2 = new AccessPoint(13803418548714,"Black Rock", 66, 30, 1);
var AP3 = new AccessPoint(13803418555583,"Spark Bars", 138, 20, 2);
var AP4 = new AccessPoint(13803418562318,"Cal Hacks Bar", 105, 20, 1);
var AP5 = new AccessPoint(13803418555412,"Meraki Bar", 93, 20, 2);
var AP6 = new AccessPoint(13803418555600,"Meraki Corner 14:d0", 30, 30, 2);
var AP7 = new AccessPoint(13803418528390,"Spark Corner", 45, 30, 2);
var AP8 = new AccessPoint(13803418544460,"Stadium Mezzanine Right", 12, 40, 4);
var AP9 = new AccessPoint(13803418550744,"Stadium Club Left", 21, 30, 3);
var AP10 = new AccessPoint(13803418550705,"Stadium Club Center", 15, 40, 3);
var AP11 = new AccessPoint(13803418544494,"Stadium Mezzanine Center", 18, 20, 4);
var AP12 = new AccessPoint(13803418531126,"Stadium Mezzanine Left", 3, 40, 4);
var AP13 = new AccessPoint(13803418549765,"Stadium Club Right", 15, 30, 3);

var APList = [AP0,AP1,AP2,AP3,AP4,AP5,AP6,AP7,AP8,AP9,AP10,AP11,AP12,AP13]
optimizationnation(APList);

</script>








<div class="row-fluid show-grid">
    <div class="span6">
    	<div id="example-table"></div>
    	<script>
    	//create Tabulator on DOM element with id "example-table"
		$("#example-table").tabulator({
    	height:478, // set height of table, this enables the Virtual DOM and improves render speed dramatically (can be any valid css height value)
    	fitColumns:true, //fit columns to width of table (optional)
    	columns:[ //Define Table Columns
        {title:"Name", field:"name", width:150},
        {title:"Floor level", field:"lev", sorter:"number"},
        {title:"Floorpercent", field:"percent", align:"left", formatter:"progress"},
        {title:"Clients", field:"client"},
        {title:"Optimitzation", field:"opt", align:"left", formatter:"progress"},
    ],
    rowClick:function(e, row){ //trigger an alert message when the row is clicked
        alert("Row " + row.getData().id + " Clicked!!!!");
    },
});

//define some sample data
var tabledata = [
    {id:1, name:APList[0].name, percent:APList[0].percent, client:APList[0].clients, lev:APList[0].level, opt:APList[0].optimization},
    {id:2, name:APList[1].name, percent:APList[1].percent, client:APList[1].clients, lev:APList[1].level, opt:APList[1].optimization},
    {id:3, name:APList[2].name, percent:APList[2].percent, client:APList[2].clients, lev:APList[2].level, opt:APList[2].optimization},
    {id:4, name:APList[3].name, percent:APList[3].percent, client:APList[3].clients, lev:APList[3].level, opt:APList[3].optimization},
    {id:5, name:APList[4].name, percent:APList[4].percent, client:APList[4].clients, lev:APList[4].level, opt:APList[4].optimization},
    {id:6, name:APList[5].name, percent:APList[5].percent, client:APList[5].clients, lev:APList[5].level, opt:APList[5].optimization},
    {id:7, name:APList[6].name, percent:APList[6].percent, client:APList[6].clients, lev:APList[6].level, opt:APList[6].optimization},
    {id:8, name:APList[7].name, percent:APList[7].percent, client:APList[7].clients, lev:APList[7].level, opt:APList[7].optimization},
    {id:9, name:APList[8].name, percent:APList[8].percent, client:APList[8].clients, lev:APList[8].level, opt:APList[8].optimization},
    {id:10, name:APList[9].name, percent:APList[9].percent, client:APList[9].clients, lev:APList[9].level, opt:APList[9].optimization},
    {id:11, name:APList[10].name, percent:APList[10].percent, client:APList[10].clients, lev:APList[10].level, opt:APList[10].optimization},
    {id:12, name:APList[11].name, percent:APList[11].percent, client:APList[11].clients, lev:APList[11].level, opt:APList[11].optimization},
    {id:13, name:APList[12].name, percent:APList[12].percent, client:APList[12].clients, lev:APList[12].level, opt:APList[12].optimization},
    {id:14, name:APList[13].name, percent:APList[13].percent, client:APList[13].clients, lev:APList[13].level, opt:APList[12].optimization},
];

//load sample data into the table
$("#example-table").tabulator("setData", tabledata);

		
    	</script>
    </div>
    <div class="span6">
    	get rekt
    </div>
</div>
<form>
<select id="myList" >
  <option value="default">None</option>
  <option value=0>0</option>
  <option value=1>1</option>  
  <option value=2>2</option>
  <option value=3>3</option>	
  <option value=4>4</option>  
  <option value=5>5</option>
  <option value=6>6</option>
  <option value=7>7</option>  
  <option value=8>8</option>
  <option value=9>9</option>
  <option value=10>10</option>  
  <option value=11>11</option>
  <option value=12>12</option>
  <option value=13>13</option>  
</select>
<form>
<script>
document.getElementById("myList").onchange = function() {
	emergencyupdate(APList[this.value],APList);
	APList[this.value].percent = 0;
	APList[this.value].clients = 0;
var tabledata = [
    {id:1, name:APList[0].name, percent:APList[0].percent, client:APList[0].clients, lev:APList[0].level, opt:APList[0].optimization},
    {id:2, name:APList[1].name, percent:APList[1].percent, client:APList[1].clients, lev:APList[1].level, opt:APList[1].optimization},
    {id:3, name:APList[2].name, percent:APList[2].percent, client:APList[2].clients, lev:APList[2].level, opt:APList[2].optimization},
    {id:4, name:APList[3].name, percent:APList[3].percent, client:APList[3].clients, lev:APList[3].level, opt:APList[3].optimization},
    {id:5, name:APList[4].name, percent:APList[4].percent, client:APList[4].clients, lev:APList[4].level, opt:APList[4].optimization},
    {id:6, name:APList[5].name, percent:APList[5].percent, client:APList[5].clients, lev:APList[5].level, opt:APList[5].optimization},
    {id:7, name:APList[6].name, percent:APList[6].percent, client:APList[6].clients, lev:APList[6].level, opt:APList[6].optimization},
    {id:8, name:APList[7].name, percent:APList[7].percent, client:APList[7].clients, lev:APList[7].level, opt:APList[7].optimization},
    {id:9, name:APList[8].name, percent:APList[8].percent, client:APList[8].clients, lev:APList[8].level, opt:APList[8].optimization},
    {id:10, name:APList[9].name, percent:APList[9].percent, client:APList[9].clients, lev:APList[9].level, opt:APList[9].optimization},
    {id:11, name:APList[10].name, percent:APList[10].percent, client:APList[10].clients, lev:APList[10].level, opt:APList[10].optimization},
    {id:12, name:APList[11].name, percent:APList[11].percent, client:APList[11].clients, lev:APList[11].level, opt:APList[11].optimization},
    {id:13, name:APList[12].name, percent:APList[12].percent, client:APList[12].clients, lev:APList[12].level, opt:APList[12].optimization},
    {id:14, name:APList[13].name, percent:APList[13].percent, client:APList[13].clients, lev:APList[13].level, opt:APList[12].optimization},
];

	$("#example-table").tabulator("setData", tabledata);
};
</script>


</body

